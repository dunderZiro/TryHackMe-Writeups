# Pwnkit: CVE-2021-4034
[https://tryhackme.com/room/pwnkit](https://tryhackme.com/room/pwnkit)

Difficulty: Walkthrough

## Information:
CVE-2021-4034 (dubbed "Pwnkit") is a LPE (Local Privilege Escalation) vulnerability located in the "Polkit" package which is a default package on most Linux distributions.

This vulnerability allows a local, low-privileged user to escalate to an administrativce role.


## Practical exploit
[Example Exploit Written in C](https://github.com/arthepsy/CVE-2021-4034/blob/main/cve-2021-4034-poc.c)

Compiled using: `gcc cve-2021-4034-poc.c -o root-shell-cve-2021-4034`

This exploit uses the GCONV_PATH environment variable to include a malicious shared object file that calls the /bin/sh shell binary with root permissions. It's as simple as compiling the c code and running the binary.

## Mitigation & Remediations
If no patches are available for the Operating System this package is installed on you can remove the SUID-bit from the pkexec binary as a form of temporary mitigation by using the following command: `chmod 0755 /usr/bin/pkexec`

